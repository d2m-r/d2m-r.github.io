<!DOCTYPE html>
<html lang="en"><head>
<link href="../images/icons/hex3.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-eedebf623301b1c3b9a877dd695003c7.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/bootstrap-icons-1.13.1/bootstrap-icons.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <meta name="dcterms.date" content="2026-02-10">
  <title>Data to Manuscript in R – Tidyverse Wrangling with Factors</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        background-color: #f5f5f5;
        color: #7e7e7e;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #7e7e7e;  padding-left: 4px; }
    div.sourceCode
      { color: #000000; background-color: #fcfcfc; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #000000; } /* Normal */
    code span.al { color: #e78ac3; background-color: #fcfcfc; font-weight: bold; } /* Alert */
    code span.an { color: #1f78b4; background-color: #f4fafd; font-style: italic; } /* Annotation */
    code span.at { color: #15712a; } /* Attribute */
    code span.bn { color: #a6761d; } /* BaseN */
    code span.bu { color: #0c7149; } /* BuiltIn */
    code span.cf { color: #6f1ba0; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #6a3d9a; } /* Char */
    code span.cn { color: #a6761d; } /* Constant */
    code span.co { color: #1f78b4; background-color: #f4fafd; font-style: italic; } /* Comment */
    code span.cv { color: #1f78b4; background-color: #f4fafd; font-style: italic; } /* CommentVar */
    code span.do { color: #1f78b4; background-color: #f4fafd; font-style: italic; } /* Documentation */
    code span.dt { color: #000000; } /* DataType */
    code span.dv { color: #0d481b; font-weight: bold; } /* DecVal */
    code span.er { color: #842222; text-decoration: underline; } /* Error */
    code span.ex { color: #0c7149; font-weight: bold; } /* Extension */
    code span.fl { color: #0d481b; font-weight: bold; } /* Float */
    code span.fu { color: #0c7149; } /* Function */
    code span.im { color: #15712a; font-style: italic; } /* Import */
    code span.in { color: #6f1ba0; font-weight: bold; } /* Information */
    code span.kw { color: #6f1ba0; font-weight: bold; } /* Keyword */
    code span.op { color: #b5089d; } /* Operator */
    code span.ot { color: #15712a; font-style: italic; } /* Other */
    code span.pp { color: #15712a; font-style: italic; } /* Preprocessor */
    code span.re { color: #b9d9f9; background-color: #888888; } /* RegionMarker */
    code span.sc { color: #6a3d9a; } /* SpecialChar */
    code span.ss { color: #6a3d9a; } /* SpecialString */
    code span.st { color: #6a3d9a; } /* String */
    code span.va { color: #000000; } /* Variable */
    code span.vs { color: #6a3d9a; } /* VerbatimString */
    code span.wa { color: #842222; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-2df988636e8508ec13f66a55c4600518.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-code-focus/codefocus.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script type="text/javascript" src="../theme/bubbles.js"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Tidyverse Wrangling with Factors</h1>
  <p class="subtitle">factors, levels, categorical data w/ base &amp; <code>forcats</code></p>

<div class="quarto-title-authors">
</div>

  <p class="date">2026-02-10</p>
</section>
<section>
<section id="introduction-to-factors" class="title-slide slide level1 center">
<h1>Introduction to Factors</h1>

</section>
<section id="categorical-data" class="slide level2">
<h2>Categorical Data</h2>
<div class="overlap-box">
<div class="box-title">
<p>Categorical variables</p>
</div>
<div class="box-content">
<ul>
<li class="fragment">Represent a set of distinct groups or categories that are:</li>
<li class="fragment">Finite in number</li>
<li class="fragment">Mutually exclusive</li>
<li class="fragment">Non-numeric
<ul>
<li class="fragment">i.e., mathematical operations don’t make sense</li>
</ul></li>
</ul>
</div>
</div>
<div class="overlap-box accent1">
<div class="box-title">
<p>Examples</p>
</div>
<div class="box-content">
<ul>
<li class="fragment">Gender</li>
<li class="fragment">Education level</li>
<li class="fragment">Survey responses (e.g., “Agree”, “Neutral”, “Disagree”)</li>
</ul>
</div>
</div>
</section>
<section id="categorical-data-types" class="slide level2">
<h2>Categorical Data Types</h2>
<div class="overlap-box">
<div class="box-title">
<p>Category Types</p>
</div>
<div class="box-content">
<ul>
<li class="fragment"><strong>Nominal</strong>: No inherent order (e.g., colors, types of fruit)</li>
<li class="fragment"><strong>Ordinal</strong>: Meaningful order (e.g., “Low”, “Medium”, “High”)</li>
</ul>
</div>
</div>
<div class="overlap-box accent1">
<div class="box-title">
<p>Also known as</p>
</div>
<div class="box-content">
<ul>
<li class="fragment">Factor variables</li>
<li class="fragment">Discrete variables</li>
<li class="fragment">Qualitative data
<ul>
<li class="fragment">Terrible. Don’t call it that.</li>
</ul></li>
</ul>
</div>
</div>
<aside class="notes">
<p>Do not call categorical data “qualitative data.” It’s a terrible name that misrepresents what categorical data is. Categorical data is still data, and it can be analyzed quantitatively (e.g., counts, proportions, regression models). The term “qualitative” implies that it’s not data or not quantitatively analyzable, which is incorrect and misleading.</p>
<p>It also discredits the value of actual qualitative data (like interview transcripts, open-ended survey responses, etc.) by lumping it together with categorical data, which is a completely different type of data that requires different methods of analysis.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="factor-data" class="slide level2">
<h2>Factor data</h2>
<ul>
<li class="fragment"><span class="keyword">Factors</span> are R’s representation of categorical data</li>
<li class="fragment">Integer vectors with level labels</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>, <span class="st">"medium"</span>, <span class="st">"low"</span>))</span>
<span id="cb1-2"><a></a></span>
<span id="cb1-3"><a></a><span class="fu">typeof</span>(f)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="fu">str</span>(f)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 3 levels "high","low","medium": 2 3 1 3 2</code></pre>
</div>
</div>
</div>
</section>
<section id="factors-vs.-strings" class="slide level2">
<h2>Factors vs.&nbsp;strings</h2>
<div class="container-fluid">
<div class="row">
<div class="col-6">
<div class="overlap-box">
<div class="box-title">
<p>Factors</p>
</div>
<div class="box-content">
<ul>
<li class="fragment">Stored as integers with labels</li>
<li class="fragment">Memory efficient (at large scale)</li>
<li class="fragment">Control ordering</li>
<li class="fragment">Useful for:
<ul>
<li class="fragment">non-numeric modeling</li>
<li class="fragment">visualization</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="col-6">
<div class="overlap-box accent1">
<div class="box-title">
<p>Strings</p>
</div>
<div class="box-content">
<ul>
<li class="fragment">Stored as many ordered character units</li>
<li class="fragment">More memory (at large scale)</li>
<li class="fragment">Flexible manipulation</li>
<li class="fragment">Useful for:
<ul>
<li class="fragment">text processing</li>
<li class="fragment">unique values</li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="memory-efficiency" class="slide level2">
<h2>Memory efficiency</h2>
<p>Compare object size of factor vs character vector with repeated values</p>
<div class="row">
<div class="col-4 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="co"># Small scale </span></span>
<span id="cb5-2"><a></a>small_strings <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb5-3"><a></a>    <span class="st">"low"</span>, <span class="st">"medium"</span>, </span>
<span id="cb5-4"><a></a>    <span class="st">"high"</span>, <span class="st">"medium"</span>, <span class="st">"low"</span>)</span>
<span id="cb5-5"><a></a>small_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(small_strings)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a><span class="co"># Strings: ~.3 KB</span></span>
<span id="cb6-2"><a></a><span class="fu">object.size</span>(small_strings) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>264 bytes</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a><span class="co"># Factor: ~.7 KB - negligibly larger</span></span>
<span id="cb8-2"><a></a><span class="fu">object.size</span>(small_factor) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>664 bytes</code></pre>
</div>
</div>
</div>
<div class="col-4 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a><span class="co"># Larger scale</span></span>
<span id="cb10-2"><a></a>big_strings <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(</span>
<span id="cb10-3"><a></a>    <span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>), </span>
<span id="cb10-4"><a></a>    <span class="at">length.out =</span> <span class="dv">10000</span>) <span class="co"># repeat to length 10,000</span></span>
<span id="cb10-5"><a></a>big_factors <span class="ot">&lt;-</span> <span class="fu">factor</span>(big_strings)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="co"># Strings: ~80.2 KB</span></span>
<span id="cb11-2"><a></a><span class="fu">object.size</span>(big_strings)  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>80216 bytes</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="co"># Factor:  ~40.6 KB - ~50% smaller</span></span>
<span id="cb13-2"><a></a><span class="fu">object.size</span>(big_factors)  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>40632 bytes</code></pre>
</div>
</div>
</div>
<div class="col-4 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a><span class="co"># Long strings</span></span>
<span id="cb15-2"><a></a>long_strings <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(</span>
<span id="cb15-3"><a></a>    <span class="st">"Dissatisfied, very dissatisfied, or extremely dissatisfied"</span>, </span>
<span id="cb15-4"><a></a>    <span class="st">"Not at all dissatisfied, somewhat dissatisfied, or a little dissatisfied"</span>, </span>
<span id="cb15-5"><a></a>    <span class="st">"Neutral and/or no response given"</span>), </span>
<span id="cb15-6"><a></a>    <span class="at">length.out =</span> <span class="dv">2000</span>) <span class="co"># repeat to length 2,000</span></span>
<span id="cb15-7"><a></a>long_factors <span class="ot">&lt;-</span> <span class="fu">factor</span>(long_strings)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a><span class="co"># Strings: ~8.4 KB</span></span>
<span id="cb16-2"><a></a><span class="fu">object.size</span>(long_strings) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>16432 bytes</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a><span class="co"># Factor: ~4.8 KB - ~50% smaller</span></span>
<span id="cb18-2"><a></a><span class="fu">object.size</span>(long_factors)  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>8848 bytes</code></pre>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Break point for memory efficiency is somewhere around 200ish strings (depending on length, number of unique levels, etc.). For small datasets where strings are more or equally efficient, it’s not going to matter enough to care about the size distinction. For enormous datasets where you do need to care about efficiency, that’s where factors do impact processing notably.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="base-r-factor-functions" class="slide level2">
<h2>Base R factor functions</h2>
<div class="row">
<div class="col-6">
<p><strong>Core base R factor functions:</strong></p>
<ul>
<li class="fragment"><code>factor()</code>: Create factor</li>
<li class="fragment"><code>levels()</code>: View/set levels</li>
<li class="fragment"><code>nlevels()</code>: Count levels</li>
<li class="fragment"><code>as.character()</code>: Convert to string</li>
<li class="fragment"><code>as.numeric()</code>: Get underlying integers</li>
</ul>
</div>
<div class="col-6 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>, <span class="st">"medium"</span>, <span class="st">"low"</span>))</span>
<span id="cb20-2"><a></a></span>
<span id="cb20-3"><a></a><span class="fu">levels</span>(f)  <span class="co"># View levels</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "high"   "low"    "medium"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a><span class="fu">nlevels</span>(f) <span class="co"># Count levels</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a><span class="fu">as.character</span>(f)  <span class="co"># Convert to strings</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "low"    "medium" "high"   "medium" "low"   </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a><span class="fu">as.numeric</span>(f)  <span class="co"># Get underlying integers</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 3 1 3 2</code></pre>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Integers are assigned in alphabetical order by default (high=1, low=2, medium=3), not order of appearance.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="forcats-package-simplify-working-with-factors" class="slide level2 left-sidebar-slide" data-fullscreen="true" style="font-size: .8;">
<h2><code>forcats</code> package: simplify working with factors</h2>
<p><img data-src="../images/icons/tv-icons/forcats.png" class="absolute" style="top: .5em; left: 1em; height: 3em; z-index: 10;; "></p>
<div class="sidebar-column">
<div class="sidebar-title">
<p><span class="pkg">forcats</span>: <br> Simplify working with factors</p>
</div>
<div class="sidebar-content">
<ul>
<li class="fragment">Tidyverse package _<strong>for cat</strong>_egorical variables</li>
<li class="fragment">Largely helpers/wrapper for base R functions with:
<ul>
<li class="fragment">Consistent <code>fct_*</code> naming</li>
<li class="fragment">More intuitive syntax</li>
<li class="fragment">Better compatibility with tidyverse workflows</li>
<li class="fragment">Additional functionality for common tasks</li>
</ul></li>
</ul>
</div>
</div>
<div class="main-content">
<div class="r-stretch" style="display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: minmax(0, 1fr) minmax(0, 1fr); gap: 0.8em;">
<div class="contained-box fragment" style="display: flex; flex-direction: column; align-items: center; padding: 0.4em 0.3em 0.2em 0.3em;">
<div class="box-icon" style="margin-bottom: 0.1em;">
<p><i class="bi-boxes " style="" role="img" aria-hidden="true"></i></p>
</div>
<div class="box-title" style="font-size: 0.9em; margin-bottom: 0.2em;">
<div style="margin-bottom: -.4em !important; margin-top: -.4em !important;">
<p>Create</p>
</div>
</div>
<div class="box-content" style="text-align: center;">
<p>Create factors</p>
</div>
</div>
<div class="contained-box fragment" style="display: flex; flex-direction: column; align-items: center; padding: 0.4em 0.3em 0.2em 0.3em;">
<div class="box-icon" style="margin-bottom: 0.1em;">
<p><i class="bi-search " style="" role="img" aria-hidden="true"></i></p>
</div>
<div class="box-title" style="font-size: 0.9em; margin-bottom: 0.2em;">
<div style="margin-bottom: -.4em !important; margin-top: -.4em !important;">
<p>Inspect</p>
</div>
</div>
<div class="box-content" style="text-align: center;">
<p>Examine levels</p>
</div>
</div>
<div class="contained-box fragment" style="display: flex; flex-direction: column; align-items: center; padding: 0.4em 0.3em 0.2em 0.3em;">
<div class="box-icon" style="margin-bottom: 0.1em;">
<p><i class="bi-intersect " style="" role="img" aria-hidden="true"></i></p>
</div>
<div class="box-title" style="font-size: 0.9em; margin-bottom: 0.2em;">
<div style="margin-bottom: -.4em !important; margin-top: -.4em !important;">
<p>Combine</p>
</div>
</div>
<div class="box-content" style="text-align: center;">
<p>Combine and standardize levels</p>
</div>
</div>
<div class="contained-box fragment" style="display: flex; flex-direction: column; align-items: center; padding: 0.4em 0.3em 0.2em 0.3em;">
<div class="box-icon" style="margin-bottom: 0.1em;">
<p><i class="bi-sort-down " style="" role="img" aria-hidden="true"></i></p>
</div>
<div class="box-title" style="font-size: 0.9em; margin-bottom: 0.2em;">
<div style="margin-bottom: -.4em !important; margin-top: -.4em !important;">
<p>Reorder</p>
</div>
</div>
<div class="box-content" style="text-align: center;">
<p>Change level order</p>
</div>
</div>
<div class="contained-box fragment" style="display: flex; flex-direction: column; align-items: center; padding: 0.4em 0.3em 0.2em 0.3em;">
<div class="box-icon" style="margin-bottom: 0.1em;">
<p><i class="bi-recycle " style="" role="img" aria-hidden="true"></i></p>
</div>
<div class="box-title" style="font-size: 0.9em; margin-bottom: 0.2em;">
<div style="margin-bottom: -.4em !important; margin-top: -.4em !important;">
<p>Reassign</p>
</div>
</div>
<div class="box-content" style="text-align: center; overflow: hidden; min-height: 0; font-size: 0.9em; line-height: .9;">
<p>Rename and redistribute levels</p>
</div>
</div>
<div class="contained-box fragment" style="display: flex; flex-direction: column; align-items: center; padding: 0.4em 0.3em 0.2em 0.3em;">
<div class="box-icon" style="margin-bottom: 0.1em;">
<p><i class="bi-plus-slash-minus " style="" role="img" aria-hidden="true"></i></p>
</div>
<div class="box-title" style="font-size: 0.9em; margin-bottom: 0.2em;">
<div style="margin-bottom: -.4em !important; margin-top: -.4em !important;">
<p>Add/Drop</p>
</div>
</div>
<div class="box-content" style="text-align: center;">
<p>Add or remove levels</p>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Create: <code>as_factor</code> Inspect: <code>fct_unique</code>, <code>fct_count</code>, <code>fct_match</code> Combine: <code>fct_c</code>, <code>fct_unify</code> Reorder: <code>fct_relevel</code>, <code>fct_infreq</code>, <code>fct_reorder</code>, <code>fct_reorder2</code>, <code>fct_rev</code>, <code>fct_inorder</code>, <code>fct_shift</code>, <code>fct_shuffle</code> Reassign: <code>fct_recode</code>, <code>fct_relabel</code>, <code>fct_anon</code>, <code>fct_collapse</code>, <code>fct_lump_*n</code>, <code>fct_other</code> Add/Drop: <code>fct_expand</code>, <code>fct_drop</code>, <code>fct_na_value_to_level</code></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="create-factors" class="title-slide slide level1 center">
<h1>Create Factors</h1>

</section>
<section id="create-factors-1" class="slide level2">
<h2>Create factors</h2>
<div class="row">
<div class="col-6">
<div class="fragment">
<ul>
<li class="fragment"><strong>Base:</strong> Create factors with <code>factor()</code>
<ul>
<li class="fragment">Alphabetizes levels by default</li>
<li class="fragment">Includes arguments to specify order, labels, and more</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a></a><span class="co"># Using factor()</span></span>
<span id="cb28-2"><a></a>f1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>, <span class="st">"medium"</span>, <span class="st">"low"</span>))</span>
<span id="cb28-3"><a></a><span class="fu">levels</span>(f1)  <span class="co"># Alphabetical order</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "high"   "low"    "medium"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a></a><span class="fu">as.numeric</span>(f1)  <span class="co"># high=1, low=2, medium=3</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 3 1 3 2</code></pre>
</div>
</div>
</div>
</div>
<div class="col-6">
<div class="fragment">
<ul>
<li class="fragment"><strong><code>forcats</code>:</strong> Create factors with <code>as_factor()</code>
<ul>
<li class="fragment">Preserves order of appearance</li>
<li class="fragment">No additional specification needed or possible <br><br></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a></a><span class="co"># Using as_factor() from forcats</span></span>
<span id="cb32-2"><a></a>f2 <span class="ot">&lt;-</span> <span class="fu">as_factor</span>(<span class="fu">c</span>(<span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>, <span class="st">"medium"</span>, <span class="st">"low"</span>))</span>
<span id="cb32-3"><a></a><span class="fu">levels</span>(f2)  <span class="co"># Order of appearance</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "low"    "medium" "high"  </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a></a><span class="fu">as.numeric</span>(f2)  <span class="co"># low=1, medium=2, high=3</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 2 1</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="create-specify-level-order" class="slide level2">
<h2>Create: specify level order</h2>
<div class="row">
<div class="col-6">
<ul>
<li class="fragment">Define levels when creating factors: <code>f &lt;- factor(x, levels = c(...))</code>
<ul>
<li class="fragment"><code>levels</code> argument: Set specific levels and order</li>
<li class="fragment">Overrides default (alphabetical)</li>
<li class="fragment">Elements of <code>levels</code> vector must match unique values in <code>x</code></li>
<li class="fragment">Levels not in <code>x</code> will be created but have no observations</li>
<li class="fragment">Observations in <code>x</code> without corresponding levels will become NA</li>
</ul></li>
<li class="fragment"><em>no forcats function</em>
<ul>
<li class="fragment"><code>as_factor()</code> necessarily preserves order of appearance</li>
</ul></li>
</ul>
</div>
<div class="col-6 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>)</span>
<span id="cb36-2"><a></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(x, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>))</span>
<span id="cb36-3"><a></a>f</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] B A C A B
Levels: C B A</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a></a><span class="fu">levels</span>(f)  <span class="co"># Custom order</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C" "B" "A"</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="create-specify-level-labels" class="slide level2">
<h2>Create: specify level labels</h2>
<p><code>factor(x, levels = c(...), labels = c(...))</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="row">
<div class="col-6 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a></a>f_levels_only <span class="ot">&lt;-</span> <span class="fu">factor</span>(x, </span>
<span id="cb41-2"><a></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>))</span>
<span id="cb41-3"><a></a></span>
<span id="cb41-4"><a></a>f_levels_only <span class="co"># Custom order, default labels</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] B A C A B
Levels: C B A</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a></a><span class="fu">levels</span>(f_levels_only)  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C" "B" "A"</code></pre>
</div>
</div>
</div>
<div class="col-6 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a></a>f_with_labels <span class="ot">&lt;-</span> <span class="fu">factor</span>(x, </span>
<span id="cb45-2"><a></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>), </span>
<span id="cb45-3"><a></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Gamma"</span>, <span class="st">"Beta"</span>, <span class="st">"Alpha"</span>))</span>
<span id="cb45-4"><a></a>f_with_labels <span class="co"># Custom order &amp; labels</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Beta  Alpha Gamma Alpha Beta 
Levels: Gamma Beta Alpha</code></pre>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>In other languages (like Stata), factors can have both levels and labels, where levels are the underlying values and labels are the human-readable names. In R, the <code>levels</code> of a factor serve both purposes: they define the unique categories (levels) and also provide the labels that are displayed when you print the factor. When you use the <code>labels</code> argument in <code>factor()</code>, it essentially renames the levels to the specified labels. So in R, levels and labels are intertwined, and you control both with the <code>levels</code> and <code>labels</code> arguments when creating a factor.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="create-specify-meaningful-order" class="slide level2">
<h2>Create: specify meaningful order</h2>
<p><strong>For ordinal data with meaningful order</strong></p>
<ul>
<li class="fragment">Likert scales (Strongly Disagree → Strongly Agree)</li>
<li class="fragment">Education levels (HS → Bachelor’s → Master’s → PhD)</li>
<li class="fragment">Sizes (Small → Medium → Large)</li>
</ul>
<div class="bubble-chain">
<p class="bubble-left fragment">
Didn’t we just define and redefine order?
</p>
<p class="bubble-right fragment">
Kind of. Regular factors have levels with no inherent order (nominal data), where the “order” is simply how R stores and displays them. Ordered factors explicitly encode an order among the levels (ordinal data).
</p>
</div>
</section>
<section id="create-ordered-vs.-unordered-factors" class="slide level2">
<h2>Create: ordered vs.&nbsp;unordered factors</h2>
<div class="row">
<div class="col-6 fragment">
<p><code>factor(..., ordered = TRUE)</code>:</p>
<p>Encode order with argument</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a></a>sizes_unordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb47-2"><a></a>    <span class="fu">c</span>(<span class="st">"medium"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>, <span class="st">"small"</span>, <span class="st">"medium"</span>),</span>
<span id="cb47-3"><a></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"small"</span>, <span class="st">"medium"</span>, <span class="st">"large"</span>),</span>
<span id="cb47-4"><a></a>    <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-5"><a></a>sizes_unordered</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] medium small  large  small  medium
Levels: small &lt; medium &lt; large</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a></a><span class="fu">levels</span>(sizes_unordered)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "small"  "medium" "large" </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a></a><span class="fu">as.numeric</span>(sizes_unordered) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 1 3 1 2</code></pre>
</div>
</div>
</div>
<div class="col-6 fragment">
<p><code>ordered(...)</code>:</p>
<p>Create ordered factor directly</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a></a>sizes_ordered <span class="ot">&lt;-</span> <span class="fu">ordered</span>(</span>
<span id="cb53-2"><a></a>    <span class="fu">c</span>(<span class="st">"medium"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>, <span class="st">"small"</span>, <span class="st">"medium"</span>),</span>
<span id="cb53-3"><a></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"small"</span>, <span class="st">"medium"</span>, <span class="st">"large"</span>))</span>
<span id="cb53-4"><a></a>sizes_ordered</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] medium small  large  small  medium
Levels: small &lt; medium &lt; large</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a></a><span class="fu">levels</span>(sizes_ordered)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "small"  "medium" "large" </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a></a><span class="fu">as.numeric</span>(sizes_ordered) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 1 3 1 2</code></pre>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Levels always have an order, because they are stored as integers and integers are necessarily ordered. <em>Ordered</em> factors explicitly encode that order for ordinal data. This allows for meaningful comparisons and appropriate statistical treatment in models.</p>
<p>When you actually view the contents of an ordered factor, you’ll see that its levels aren’t just listed in order, they have <code>&lt;</code> between them. This is saying to the human user (and R functions that respect ordered factors) that there is a meaningful order to these levels, not simply an arbitrary assignment to numerals that happen to have an order because that’s how numbers work.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="meaningful-ordering" class="slide level2">
<h2>Meaningful ordering</h2>
<div class="row">
<div class="col-6 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a></a>sizes_unordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb59-2"><a></a>    <span class="fu">c</span>(<span class="st">"medium"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>, <span class="st">"small"</span>, <span class="st">"medium"</span>),</span>
<span id="cb59-3"><a></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"small"</span>, <span class="st">"medium"</span>, <span class="st">"large"</span>),</span>
<span id="cb59-4"><a></a>    <span class="at">ordered =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-5"><a></a></span>
<span id="cb59-6"><a></a>sizes_unordered</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] medium small  large  small  medium
Levels: small medium large</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a></a>sizes_unordered[<span class="dv">1</span>] <span class="sc">&lt;</span> sizes_unordered[<span class="dv">3</span>]  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a></a>sizes_unordered[<span class="dv">2</span>] <span class="sc">&gt;</span> sizes_unordered[<span class="dv">4</span>]  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a></a>sizes_unordered[<span class="dv">2</span>] <span class="sc">==</span> sizes_unordered[<span class="dv">4</span>] </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</div>
<div class="col-6 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a></a>sizes_ordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb67-2"><a></a>    <span class="fu">c</span>(<span class="st">"medium"</span>, <span class="st">"small"</span>, <span class="st">"large"</span>, <span class="st">"small"</span>, <span class="st">"medium"</span>),</span>
<span id="cb67-3"><a></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"small"</span>, <span class="st">"medium"</span>, <span class="st">"large"</span>),</span>
<span id="cb67-4"><a></a>    <span class="at">ordered =</span> <span class="cn">TRUE</span>) <span class="co"># or use ordered() function</span></span>
<span id="cb67-5"><a></a></span>
<span id="cb67-6"><a></a>sizes_ordered</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] medium small  large  small  medium
Levels: small &lt; medium &lt; large</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a></a>sizes_ordered[<span class="dv">1</span>] <span class="sc">&lt;</span> sizes_ordered[<span class="dv">3</span>]  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a></a>sizes_ordered[<span class="dv">2</span>] <span class="sc">&gt;</span> sizes_ordered[<span class="dv">4</span>]  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a></a>sizes_ordered[<span class="dv">2</span>] <span class="sc">==</span> sizes_ordered[<span class="dv">4</span>] </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="inspect-factors" class="slide level2">
<h2>Inspect factors</h2>
<div class="row">
<div class="col-5">
<p><strong>Examine existing factor structure</strong></p>
</div>
<div class="col-7">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"medium"</span>, <span class="st">"high"</span>, <span class="st">"low"</span>, <span class="st">"high"</span>, <span class="st">"high"</span>, <span class="st">"medium"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
<div class="row">
<div class="col-6">
<div class="fragment">
<ul>
<li class="fragment">Base:
<ul>
<li class="fragment"><code>levels()</code>: View level labels</li>
<li class="fragment"><code>nlevels()</code>: Count levels</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a></a><span class="fu">levels</span>(x) <span class="co"># character vector</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "high"   "low"    "medium"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a></a><span class="fu">nlevels</span>(x) <span class="co"># integer count</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</div>
</div>
<div class="col-6">
<div class="fragment">
<ul>
<li class="fragment"><code>forcats</code>:
<ul>
<li class="fragment"><code>fct_unique()</code>: Unique values of levels</li>
<li class="fragment"><code>fct_count()</code>: Frequency table</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a></a><span class="fu">fct_unique</span>(x) <span class="co"># factor of levels</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] high   low    medium
Levels: high low medium</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a></a><span class="fu">fct_count</span>(x) <span class="co"># tibble of lvl &amp; ct.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  f          n
  &lt;fct&gt;  &lt;int&gt;
1 high       3
2 low        1
3 medium     2</code></pre>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Aside from <code>factor</code> and <code>levels</code>, it’s <code>forcats</code> only from here on out!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="combine-factors" class="slide level2">
<h2>Combine factors</h2>
<div class="container-fluid" style="margin-top: -3em;">
<div class="row">
<div class="col-8">

</div>
<div class="col-4">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a></a>f1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"c"</span>))</span>
<span id="cb84-2"><a></a>f2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"a"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
<div class="row">
<div class="col-6 fragment">
<p><code>fct_c()</code>: Combine factors</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a></a>f_combined <span class="ot">&lt;-</span> <span class="fu">fct_c</span>(f1, f2)</span>
<span id="cb85-2"><a></a></span>
<span id="cb85-3"><a></a>f1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] a c
Levels: a c</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a></a>f2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] b a
Levels: a b</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a></a>f_combined</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] a c b a
Levels: a c b</code></pre>
</div>
</div>
</div>
<div class="col-6 fragment">
<p><code>fct_unify()</code>: Unify levels of factors</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a></a>unified_list <span class="ot">&lt;-</span> <span class="fu">list</span>(f1, f2)</span>
<span id="cb91-2"><a></a>f_unified <span class="ot">&lt;-</span> <span class="fu">fct_unify</span>(unified_list)</span>
<span id="cb91-3"><a></a></span>
<span id="cb91-4"><a></a>f_unified</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] a c
Levels: a c b

[[2]]
[1] b a
Levels: a c b</code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="reorder-factor-levels" class="title-slide slide level1 center">
<h1>Reorder Factor Levels</h1>

</section>
<section id="reorder-manual-assignment-relevel" class="slide level2">
<h2>Reorder: manual assignment (relevel)</h2>
<p><code>fct_relevel()</code>: Move levels to specific positions</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"medium"</span>, <span class="st">"low"</span>, <span class="st">"high"</span>, <span class="st">"medium"</span>, <span class="st">"low"</span>))</span>
<span id="cb93-2"><a></a>f <span class="co"># Current order</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>[1] medium low    high   medium low   
Levels: high low medium</code></pre>
</div>
</div></div>
<div class="row">
<div class="col-6 fragment">
<p>Move specific level to front</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a></a><span class="co"># Move "low" to front</span></span>
<span id="cb95-2"><a></a><span class="fu">fct_relevel</span>(f, <span class="st">"low"</span>)  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] medium low    high   medium low   
Levels: low high medium</code></pre>
</div>
</div>
<p>Move one level relative to another</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a></a><span class="co"># Move "medium" before "high"</span></span>
<span id="cb97-2"><a></a><span class="fu">fct_relevel</span>(f, <span class="st">"medium"</span>, <span class="st">"high"</span>)  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] medium low    high   medium low   
Levels: medium high low</code></pre>
</div>
</div>
</div>
<div class="col-6 fragment">
<p>Move one level to specific position</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a></a><span class="co"># Move "high" after first level</span></span>
<span id="cb99-2"><a></a><span class="fu">fct_relevel</span>(f, <span class="st">"high"</span>, <span class="at">after =</span> <span class="dv">1</span>)  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] medium low    high   medium low   
Levels: low high medium</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a></a><span class="co"># Move "low" to last position</span></span>
<span id="cb101-2"><a></a><span class="fu">fct_relevel</span>(f, <span class="st">"low"</span>, <span class="at">after =</span> <span class="cn">Inf</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] medium low    high   medium low   
Levels: high medium low</code></pre>
</div>
</div>
</div>
</div>
<aside class="notes">
<ul>
<li>Note: Conceptually this is reordering levels, but there is a different function called <code>fct_reorder()</code> (coming up) that does reorders levels with a different mechanism. In most cases when you need to manually reorder levels, you’re going to use <code>relevel()</code>.</li>
</ul>
<p>after = 0: Move “medium” to first position (same as fct_relevel(f, “medium”)) with fct_relevel(f, “medium”, after = 0)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="reorder-reverse" class="slide level2">
<h2>Reorder: reverse</h2>
<p><code>fct_rev()</code>: Reverse current level order</p>
<div class="fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"large"</span>, <span class="st">"small"</span>, <span class="st">"medium"</span>, <span class="st">"medium"</span>, </span>
<span id="cb103-2"><a></a>    <span class="st">"small"</span>, <span class="st">"medium"</span>, <span class="st">"small"</span>, <span class="st">"medium"</span>, <span class="st">"medium"</span>, <span class="st">"medium"</span>), </span>
<span id="cb103-3"><a></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"small"</span>, <span class="st">"medium"</span>, <span class="st">"large"</span>))</span>
<span id="cb103-4"><a></a>f</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] large  small  medium medium small  medium small  medium medium medium
Levels: small medium large</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a></a><span class="fu">fct_rev</span>(f)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] large  small  medium medium small  medium small  medium medium medium
Levels: large medium small</code></pre>
</div>
</div>
</div>
</section>
<section id="fct_rev-use-case-flip-bar-chart" class="slide level2">
<h2><code>fct_rev</code> use case: flip bar chart</h2>
<p><strong>Use case</strong>: Flip bar chart from top-to-bottom to bottom-to-top</p>
<div class="row">
<div class="col-6 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(f), <span class="fu">aes</span>(<span class="at">x =</span> f)) <span class="sc">+</span> </span>
<span id="cb107-2"><a></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb107-3"><a></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bar Chart with Original Factor Order"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Q1-W6_tidyverse-factors_files/figure-revealjs/unnamed-chunk-1-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="col-6 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(f), <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_rev</span>(f))) <span class="sc">+</span></span>
<span id="cb108-2"><a></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb108-3"><a></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bar Chart with Reversed Factor Order"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Q1-W6_tidyverse-factors_files/figure-revealjs/unnamed-chunk-2-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="reorder-by-appearance" class="slide level2">
<h2>Reorder: by appearance</h2>
<p><code>fct_inorder()</code>: Order by first appearance</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>))</span>
<span id="cb109-2"><a></a>f</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>[1] b b a c c c
Levels: a b c</code></pre>
</div>
</div></div>
<div class="row">
<div class="col-6 fragment">
<p>Reorder by first appearance</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a></a><span class="fu">fct_inorder</span>(f)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] b b a c c c
Levels: b a c</code></pre>
</div>
</div>
</div>
<div class="col-6 fragment">
<p>Equivalent to creating with <code>as_factor()</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a></a>f <span class="ot">&lt;-</span> <span class="fu">as_factor</span>(<span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>))</span>
<span id="cb113-2"><a></a>f</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] b b a c c c
Levels: b a c</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="reorder-by-frequency" class="slide level2">
<h2>Reorder: by frequency</h2>
<p><code>fct_infreq()</code>: Reorder from most to least common</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>))</span>
<span id="cb115-2"><a></a>f</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] b b a c c c
Levels: a b c</code></pre>
</div>
</div>
<div class="fragment">
<p>Reorder by frequency, most common first</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a></a><span class="fu">fct_infreq</span>(f)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] b b a c c c
Levels: c b a</code></pre>
</div>
</div>
</div>
</section>
<section id="fct_infreq-use-case-interpretable-bar-charts" class="slide level2">
<h2><code>fct_infreq</code> use case: interpretable bar charts</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="row">
<div class="col-6 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(f), <span class="fu">aes</span>(<span class="at">x =</span> f)) <span class="sc">+</span></span>
<span id="cb120-2"><a></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb120-3"><a></a>    <span class="fu">labs</span>(<span class="at">title =</span></span>
<span id="cb120-4"><a></a>        <span class="st">"Bar Chart with Default (Alphabetical) Ordered Factor"</span>) <span class="sc">+</span></span>
<span id="cb120-5"><a></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Q1-W6_tidyverse-factors_files/figure-revealjs/bar-chart-default-ordered-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="col-6 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(f), <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_infreq</span>(f))) <span class="sc">+</span></span>
<span id="cb121-2"><a></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb121-3"><a></a>    <span class="fu">labs</span>(<span class="at">title =</span></span>
<span id="cb121-4"><a></a>        <span class="st">"Bar Chart with Frequency-Ordered Factor"</span>) <span class="sc">+</span></span>
<span id="cb121-5"><a></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Q1-W6_tidyverse-factors_files/figure-revealjs/bar-chart-infreq-ordered-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Probably the most common use case for <code>fct_infreq()</code> is to create bar charts with bars ordered by frequency (most common first). This is often more informative than the default alphabetical ordering.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="reorder-by-another-variable-summary" class="slide level2">
<h2>Reorder: by another variable (summary)</h2>
<p><code>fct_reorder(f, x, fun)</code>: Order factor by summary of another variable</p>
<div class="row">
<div class="col-6 fragment">
<p>Default: sort by level median</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a></a><span class="fu">ggplot</span>(diamonds_100, <span class="fu">aes</span>(</span>
<span id="cb122-2"><a></a>    <span class="at">x =</span> <span class="fu">fct_reorder</span>(cut, carat), <span class="at">y =</span> carat)) <span class="sc">+</span></span>
<span id="cb122-3"><a></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb122-4"><a></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Reordered by Median Carat Value"</span>) <span class="sc">+</span></span>
<span id="cb122-5"><a></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Q1-W6_tidyverse-factors_files/figure-revealjs/reorder-by-other-variable-median-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="col-6 fragment">
<p>Or sort by any other summary function, e.g., <code>max</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a></a><span class="fu">ggplot</span>(diamonds_100, <span class="fu">aes</span>(</span>
<span id="cb123-2"><a></a>    <span class="at">x =</span> <span class="fu">fct_reorder</span>(cut, carat, max), <span class="at">y =</span> carat)) <span class="sc">+</span></span>
<span id="cb123-3"><a></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb123-4"><a></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Reordered by Maximum Carat Value"</span>) <span class="sc">+</span></span>
<span id="cb123-5"><a></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Q1-W6_tidyverse-factors_files/figure-revealjs/reorder-by-other-variable-max-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="reorder-by-another-variable-relationship" class="slide level2">
<h2>Reorder: by another variable (relationship)</h2>
<p><code>fct_reorder2(f, x, y)</code>: Order by relationship with two variables (great for line plots)</p>
<div class="row">
<div class="col-6 fragment">
<p>Line plot without reorder</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a></a>diamonds_100 <span class="sc">|&gt;</span> </span>
<span id="cb124-2"><a></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price, </span>
<span id="cb124-3"><a></a>        <span class="at">color =</span> cut)) <span class="sc">+</span></span>
<span id="cb124-4"><a></a>    <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">fun =</span> mean) <span class="sc">+</span></span>
<span id="cb124-5"><a></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Line Plot with Legend Ordered by Endpoint"</span>) <span class="sc">+</span></span>
<span id="cb124-6"><a></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Q1-W6_tidyverse-factors_files/figure-revealjs/reorder-by-other-variable-default-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="col-6 fragment">
<p>Compare last values of y for each level of f across x</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a></a>diamonds_100 <span class="sc">|&gt;</span> </span>
<span id="cb125-2"><a></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price, </span>
<span id="cb125-3"><a></a>        <span class="at">color =</span> <span class="fu">fct_reorder2</span>(cut, carat, price))) <span class="sc">+</span></span>
<span id="cb125-4"><a></a>    <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">"summary"</span>, <span class="at">fun =</span> mean) <span class="sc">+</span></span>
<span id="cb125-5"><a></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Line Plot with Legend Ordered by Endpoint"</span>) <span class="sc">+</span></span>
<span id="cb125-6"><a></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Q1-W6_tidyverse-factors_files/figure-revealjs/reorder-by-other-variable-reorder2-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Notice that if you use a forcats variable like fct_reorder on a non-factor variable, it will convert it to a factor with the new order. This is a common way to reorder factors on the fly for plotting without needing to create a new variable in your dataset.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="reassign-factor-levels" class="title-slide slide level1 center">
<h1>Reassign Factor Levels</h1>

</section>
<section id="reassign-rename-levels" class="slide level2">
<h2>Reassign: rename levels</h2>
<p><code>fct_recode()</code>: Manually rename specific levels <code>new_name = "old_name"</code></p>
<div class="fragment">
<p>Create factor with messy level names</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Low "</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>, <span class="st">"Medium "</span>, <span class="st">"Low"</span>, <span class="st">"high"</span>, <span class="st">"Hihg"</span>))</span>
<span id="cb126-2"><a></a>f</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Low     Medium  High    Medium  Low     high    Hihg   
Levels: high High Hihg Low Low  Medium Medium </code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Clean up names. Map multiple old levels to same new or existing level individually.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a></a>f_clean <span class="ot">&lt;-</span> <span class="fu">fct_recode</span>(f,</span>
<span id="cb128-2"><a></a>                      <span class="at">Low =</span> <span class="st">"Low "</span>,</span>
<span id="cb128-3"><a></a>                      <span class="at">Medium =</span> <span class="st">"Medium "</span>,</span>
<span id="cb128-4"><a></a>                      <span class="at">High =</span> <span class="st">"high"</span>,</span>
<span id="cb128-5"><a></a>                      <span class="at">High =</span> <span class="st">"Hihg"</span>)</span>
<span id="cb128-6"><a></a></span>
<span id="cb128-7"><a></a>f_clean</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Low    Medium High   Medium Low    High   High  
Levels: High Low Medium</code></pre>
</div>
</div>
</div>
</section>
<section id="reassign-collapse-levels-manually" class="slide level2">
<h2>Reassign: collapse levels manually</h2>
<p><code>fct_collapse()</code>: Combine multiple levels into one <code>new_name = c("old1", "old2")</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="fragment">
<div class="cell columns column-output-location">
<div class="column">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a></a>f_collapsed <span class="ot">&lt;-</span> <span class="fu">fct_collapse</span>(</span>
<span id="cb131-2"><a></a>    f,</span>
<span id="cb131-3"><a></a>    <span class="at">Group1 =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb131-4"><a></a>    <span class="at">Group2 =</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"D"</span>),</span>
<span id="cb131-5"><a></a>    <span class="at">Group3 =</span> <span class="st">"E"</span>)</span>
<span id="cb131-6"><a></a></span>
<span id="cb131-7"><a></a>f_collapsed</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code> [1] Group1 Group1 Group1 Group1 Group1 Group2 Group2 Group2 Group2 Group2
[11] Group3 F      G      G      G      G      G     
Levels: Group1 Group2 Group3 F G</code></pre>
</div>
</div></div>
</div>
</section>
<section id="reassign-lump-levels-manually" class="slide level2">
<h2>Reassign: lump levels manually</h2>
<p><code>fct_other()</code>: Lump (non/)specified levels into “Other”</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="row">
<div class="col-6 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a></a><span class="fu">fct_other</span>(f, <span class="at">keep =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A     A     B     B     B     C     C     C     C     Other Other Other
[13] Other Other Other Other Other
Levels: A B C Other</code></pre>
</div>
</div>
</div>
<div class="col-6 fragment">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a></a><span class="fu">fct_other</span>(f, <span class="at">drop =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Other Other Other Other Other Other Other Other Other D     E     F    
[13] G     G     G     G     G    
Levels: D E F G Other</code></pre>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>“Lumping” is not the same as “dropping” despite the argument being “drop.” It creates an “other” level, remaps levels to “other”, then drops unused levels.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="reassign-lump-levels-automatically" class="slide level2">
<h2>Reassign: lump levels automatically</h2>
<p><code>fct_lump_*()</code> family: Keep levels by condition, lump rest into “Other”</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"G"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="row">
<div class="col-4 fragment">
<p><code>fct_lump_n()</code>: keep most frequent N</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a></a><span class="fu">fct_lump_n</span>(f, <span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Other Other B     B     B     C     C     C     C     Other Other Other
[13] G     G     G     G     G    
Levels: B C G Other</code></pre>
</div>
</div>
</div>
<div class="col-4 fragment">
<p><code>fct_lump_prop()</code>: keep levels above percent frequency</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a></a><span class="fu">fct_lump_prop</span>(f, <span class="at">prop =</span> <span class="fl">0.2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Other Other Other Other Other C     C     C     C     Other Other Other
[13] G     G     G     G     G    
Levels: C G Other</code></pre>
</div>
</div>
</div>
<div class="col-4 fragment">
<p><code>fct_lump_min()</code>: keep levels with at least N observations</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a></a><span class="fu">fct_lump_min</span>(f, <span class="at">min =</span> <span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Other Other Other Other Other C     C     C     C     Other Other Other
[13] G     G     G     G     G    
Levels: C G Other</code></pre>
</div>
</div>
</div>
</div>
<aside class="notes">
<p><strong>Collapsing levels</strong>: Use <code>fct_collapse()</code> to combine multiple levels into single level. Show <code>fct_lump()</code> to automatically lump least common levels into “Other”. Demonstrate <code>fct_lump_n()</code>, <code>fct_lump_prop()</code>, <code>fct_lump_min()</code> for different lumping strategies.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="adddrop-levels" class="title-slide slide level1 center">
<h1>Add/Drop Levels</h1>

</section>
<section id="adddrop-add-and-remove-levels" class="slide level2">
<h2>Add/Drop: add and remove levels</h2>
<div class="row">
<div class="col-4 fragment">
<p><code>fct_expand()</code>: Add new levels without observations</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a></a>f_abc <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>))</span>
<span id="cb145-2"><a></a>f_abc</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] A B C
Levels: A B C</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a></a><span class="fu">fct_expand</span>(f, <span class="st">"D"</span>, <span class="st">"E"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] A A B B B C C C C D E F G G G G G
Levels: A B C D E F G</code></pre>
</div>
</div>
</div>
<div class="col-4 fragment">
<p><code>fct_drop()</code>: Remove levels with no observations</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a></a>f_abcde <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), </span>
<span id="cb149-2"><a></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>))</span>
<span id="cb149-3"><a></a>f_abcde</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] A B C
Levels: A B C D E</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a></a><span class="fu">fct_drop</span>(f_abcde)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] A B C
Levels: A B C</code></pre>
</div>
</div>
</div>
<div class="col-4 fragment">
<p>In combination</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a></a><span class="co"># add unused levels</span></span>
<span id="cb153-2"><a></a><span class="fu">fct_expand</span>(f_abc, <span class="st">"D"</span>, <span class="st">"E"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb153-3"><a></a>    <span class="co"># then drop them</span></span>
<span id="cb153-4"><a></a>    <span class="fu">fct_drop</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] A B C
Levels: A B C</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="fct_drop-use-case-tibble-filter" class="slide level2">
<h2><code>fct_drop</code> use case: tibble filter</h2>
<div class="fragment">
<div class="cell columns column-output-location">
<div class="column">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a></a><span class="co"># Create a tibble with a factor variable</span></span>
<span id="cb155-2"><a></a>t <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb155-3"><a></a>    <span class="at">f =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>)),</span>
<span id="cb155-4"><a></a>    <span class="at">i =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb155-5"><a></a>)</span>
<span id="cb155-6"><a></a></span>
<span id="cb155-7"><a></a>t</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  f         i
  &lt;fct&gt; &lt;int&gt;
1 A         1
2 B         2
3 C         3
4 D         4
5 E         5</code></pre>
</div>
</div></div>
</div>
<div class="fragment">
<div class="cell columns column-output-location">
<div class="column">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a></a>t<span class="sc">$</span>f</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>[1] A B C D E
Levels: A B C D E</code></pre>
</div>
</div></div>
</div>
<div class="fragment">
<div class="cell columns column-output-location">
<div class="column">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a></a>t_subset <span class="ot">&lt;-</span> <span class="fu">filter</span>(t, i <span class="sc">&lt;=</span> <span class="dv">3</span>)</span>
<span id="cb159-2"><a></a>t_subset<span class="sc">$</span>f</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>[1] A B C
Levels: A B C D E</code></pre>
</div>
</div></div>
</div>
<div class="fragment">
<div class="cell columns column-output-location">
<div class="column">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a></a><span class="fu">fct_drop</span>(t_subset<span class="sc">$</span>f)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>[1] A B C
Levels: A B C</code></pre>
</div>
</div></div>
</div>
<aside class="notes">
<p><strong>Dropping unused levels</strong>: Compare <code>droplevels()</code> with <code>fct_drop()</code> to remove levels with no observations. Commonly used after filtering data.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="adddrop-handle-missing-values" class="slide level2">
<h2>Add/Drop: handle missing values</h2>
<p><code>fct_na_value_to_level()</code>: Convert between <code>NA</code> values and <code>NA</code> levels</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a></a>f <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="cn">NA</span>, <span class="st">"A"</span>, <span class="st">"C"</span>, <span class="cn">NA</span>, <span class="st">"B"</span>))</span>
<span id="cb163-2"><a></a>f</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] A    B    &lt;NA&gt; A    C    &lt;NA&gt; B   
Levels: A B C</code></pre>
</div>
</div>
<div class="row">
<div class="col-6 fragment">
<p>Create explicit NA level</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a></a><span class="fu">fct_na_value_to_level</span>(f)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] A    B    &lt;NA&gt; A    C    &lt;NA&gt; B   
Levels: A B C &lt;NA&gt;</code></pre>
</div>
</div>
</div>
<div class="col-6 fragment">
<p>Convert NAs to named level</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a></a><span class="fu">fct_na_value_to_level</span>(f, <span class="at">level =</span> <span class="st">"(Missing)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] A         B         (Missing) A         C         (Missing) B        
Levels: A B C (Missing)</code></pre>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>WHY? - Make missingness visible in plots - Include NAs in counts and summaries</p>
<p><code>fct_explicit_na()</code> is deprecated, but you’ll still see it and it still works. The new name <code>fct_na_value_to_level()</code> is more descriptive of what the function actually does, which is to convert NA to explicit “(Something)” level.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="see-also" class="slide level2 scrollable">
<h2>See Also</h2>
<p><code>forcats</code> functions we didn’t talk about:</p>
<ol type="1">
<li>Create: n/a – just <code>as_factor()</code></li>
<li>Inspect:
<ol type="1">
<li><code>fct_match(f, lvls)</code>: check for levels in f</li>
</ol></li>
<li>Combine:
<ol type="1">
<li><code>fct_cross(f1, f2)</code>: Create interaction factor</li>
</ol></li>
<li>Reorder
<ol type="1">
<li><code>fct_inseq()</code>: Order by natural sequence</li>
<li><code>fct_shift()</code>: Shift levels L or R, wrapping around</li>
<li><code>fct_shuffle()</code>: Randomly permute levels</li>
</ol></li>
<li>Modify
<ol type="1">
<li><code>fct_lump_lowfreq()</code>: Lump low-frequency levels</li>
<li><code>fct_relabel()</code>: Rename levels with function</li>
<li><code>fct_anon()</code>: Anonymize to random integers</li>
</ol></li>
</ol>
</section></section>
<section>
<section id="practical-applications" class="title-slide slide level1 center">
<h1>Practical Applications</h1>

</section>
<section id="data-cleaning-workflow" class="slide level2 scrollable">
<h2>Data cleaning workflow</h2>
<p><strong>String cleaning → Factor creation</strong></p>
<div class="row">
<div class="col-5">
<p>Common workflow:</p>
<ol type="1">
<li class="fragment">Trim whitespace</li>
<li class="fragment">Standardize case</li>
<li class="fragment">Fix inconsistencies</li>
<li class="fragment">Convert to factor</li>
</ol>
</div>
<div class="col-7">
<div class="fragment">
<p>Messy categorical (string) data with inconsistent entries</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb169"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a></a><span class="co"># Create messy data</span></span>
<span id="cb169-2"><a></a>messy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">" Low"</span>, <span class="st">"medium "</span>, <span class="st">"HIGH"</span>, <span class="st">"medium"</span>, <span class="st">" low"</span>, <span class="st">"high"</span>, <span class="cn">NA</span>, <span class="st">"Hihg"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div class="fragment">
<p>Pipeline wth <code>str</code> and factor creation in one step</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a></a>messy <span class="sc">|&gt;</span> </span>
<span id="cb170-2"><a></a>    <span class="fu">str_trim</span>() <span class="sc">|&gt;</span> </span>
<span id="cb170-3"><a></a>    <span class="fu">str_to_lower</span>() <span class="sc">|&gt;</span> </span>
<span id="cb170-4"><a></a>    <span class="fu">str_replace</span>(<span class="st">"hihg"</span>, <span class="st">"high"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb170-5"><a></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>), </span>
<span id="cb170-6"><a></a>        <span class="at">ordered =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb170-7"><a></a>    <span class="fu">fct_na_value_to_level</span>(<span class="st">"no response"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] low         medium      high        medium      low         high       
[7] no response high       
Levels: low &lt; medium &lt; high &lt; no response</code></pre>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p><strong>Data cleaning workflows</strong>: Demonstrate pipeline combining string cleaning (trimming, case conversion) with factor creation. Show fixing inconsistent categorical entries.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="visualization-preparation" class="slide level2">
<h2>Visualization preparation</h2>
<p><strong>Make better plots with factor control</strong></p>
<ul>
<li class="fragment">Reorder for sorted bars (<code>fct_infreq</code>, <code>fct_reorder</code>)</li>
<li class="fragment">Collapse rare categories (<code>fct_lump_*</code>)</li>
<li class="fragment">Control legend order</li>
</ul>
</section>
<section id="visualization-preparation-1" class="slide level2">
<h2>Visualization preparation</h2>
<div class="row">
<div class="col-5">
<p>Create a simple bar chart</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb172"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a></a>diamonds_100 <span class="sc">|&gt;</span> </span>
<span id="cb172-2"><a></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> clarity)) <span class="sc">+</span></span>
<span id="cb172-3"><a></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb172-4"><a></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bar chart with no ordering"</span>,</span>
<span id="cb172-5"><a></a>        <span class="at">x =</span> <span class="st">"Default factor variable"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div class="col-7">
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Q1-W6_tidyverse-factors_files/figure-revealjs/bar-chart-unsorted-view-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="visualization-preparation-2" class="slide level2">
<h2>Visualization preparation</h2>
<div class="row">
<div class="col-5">
<p>Reorder factor by decreasing frequency</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a></a>diamonds_100 <span class="sc">|&gt;</span> </span>
<span id="cb173-2"><a></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> </span>
<span id="cb173-3"><a></a>        <span class="fu">fct_infreq</span>(clarity))) <span class="sc">+</span></span>
<span id="cb173-4"><a></a><span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb173-5"><a></a><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bar chart with freq. ordering"</span>,</span>
<span id="cb173-6"><a></a>    <span class="at">x =</span> <span class="st">"Somewhat arranged factor variable"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div class="col-7">
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Q1-W6_tidyverse-factors_files/figure-revealjs/bar-chart-freq-view-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="visualization-preparation-3" class="slide level2">
<h2>Visualization preparation</h2>
<div class="row">
<div class="col-5">
<p>Lump rare categories for cleaner visualization</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb174"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a></a>diamonds_100 <span class="sc">|&gt;</span> </span>
<span id="cb174-2"><a></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> </span>
<span id="cb174-3"><a></a>        <span class="fu">fct_lump_n</span>(clarity, <span class="at">n =</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb174-4"><a></a>        <span class="fu">fct_infreq</span>())) <span class="sc">+</span></span>
<span id="cb174-5"><a></a><span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb174-6"><a></a><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bar chart with freq. </span></span>
<span id="cb174-7"><a></a><span class="st">    ordering + lumping"</span>,</span>
<span id="cb174-8"><a></a>    <span class="at">x =</span> <span class="st">"Cleverly arranged factor variable"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div class="col-7">
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Q1-W6_tidyverse-factors_files/figure-revealjs/bar-chart-freq-lump-view-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="visualization-preparation-4" class="slide level2">
<h2>Visualization preparation</h2>
<div class="row">
<div class="col-5">
<p>Move “other” level to the end</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb175"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a></a>diamonds_100 <span class="sc">|&gt;</span> </span>
<span id="cb175-2"><a></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> </span>
<span id="cb175-3"><a></a>        <span class="fu">fct_lump_n</span>(clarity, <span class="at">n =</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb175-4"><a></a>        <span class="fu">fct_infreq</span>() <span class="sc">|&gt;</span> </span>
<span id="cb175-5"><a></a>        <span class="fu">fct_relevel</span>(<span class="st">"Other"</span>, </span>
<span id="cb175-6"><a></a>            <span class="at">after =</span> <span class="cn">Inf</span>))) <span class="sc">+</span></span>
<span id="cb175-7"><a></a><span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb175-8"><a></a><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bar chart with freq. </span></span>
<span id="cb175-9"><a></a><span class="st">    ordering + lumping + relevel"</span>,</span>
<span id="cb175-10"><a></a>    <span class="at">x =</span> <span class="st">"Brilliantly arranged factor variable"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div class="col-7">
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Q1-W6_tidyverse-factors_files/figure-revealjs/bar-chart-freq-lump-other-end-view-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p><strong>Preparing data for visualization</strong>: Show reordering factors for sorted bar charts and line plots. Demonstrate collapsing rare categories for cleaner plots. Illustrate controlling legend order.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="modeling-categorical-data" class="slide level2">
<h2>Modeling categorical data</h2>
<p><strong>Factor order matters in models!</strong> The first level is the reference category. <em>Example:</em> using <code>mtcars</code> data, predict <code>mpg</code> using <code>cyl</code> (number of cylinders) as a factor variable.</p>
<div class="row">
<div class="col-6 fragment">
<p>Fit regression model with <code>cyl</code> as factor</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb176"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a></a><span class="fu">summary</span>(</span>
<span id="cb176-2"><a></a>    <span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="fu">factor</span>(cyl), <span class="at">data =</span> mtcars)</span>
<span id="cb176-3"><a></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ factor(cyl), data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.2636 -1.8357  0.0286  1.3893  7.2364 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   26.6636     0.9718  27.437  &lt; 2e-16 ***
factor(cyl)6  -6.9208     1.5583  -4.441 0.000119 ***
factor(cyl)8 -11.5636     1.2986  -8.905 8.57e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.223 on 29 degrees of freedom
Multiple R-squared:  0.7325,    Adjusted R-squared:  0.714 
F-statistic:  39.7 on 2 and 29 DF,  p-value: 4.979e-09</code></pre>
</div>
</div>
</div>
<div class="col-6 fragment">
<p>Use <code>fct_rev()</code> to change reference level</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb178"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a></a><span class="fu">summary</span>(</span>
<span id="cb178-2"><a></a>    <span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="fu">fct_rev</span>(<span class="fu">factor</span>(cyl)), <span class="at">data =</span> mtcars)</span>
<span id="cb178-3"><a></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ fct_rev(factor(cyl)), data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.2636 -1.8357  0.0286  1.3893  7.2364 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            15.1000     0.8614  17.529  &lt; 2e-16 ***
fct_rev(factor(cyl))6   4.6429     1.4920   3.112  0.00415 ** 
fct_rev(factor(cyl))4  11.5636     1.2986   8.905 8.57e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.223 on 29 degrees of freedom
Multiple R-squared:  0.7325,    Adjusted R-squared:  0.714 
F-statistic:  39.7 on 2 and 29 DF,  p-value: 4.979e-09</code></pre>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>The first level is the “dummy” or reference category. Output is only interpretable in relation to that first level.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>D2M-R I | Week 6 &amp; 7</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-code-focus/codefocus.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-fullscreen/fullscreen.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealCodeFocus, RevealFullscreen, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>