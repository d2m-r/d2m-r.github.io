<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Finding Data – Data to Manuscript in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/icons/hex3.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-4d84f464d1e0f5a3f55bf273987e8d96.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Data to Manuscript in R</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-syllabus" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Syllabus</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-syllabus">    
        <li>
    <a class="dropdown-item" href="../syllabus/structure.html">
 <span class="dropdown-text">Course Structure</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../syllabus/communication.html">
 <span class="dropdown-text">Communication</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../syllabus/ai-policy.html">
 <span class="dropdown-text">AI Use</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../syllabus/climate.html">
 <span class="dropdown-text">Climate &amp; Inclusion</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-assessment" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Assessment</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-assessment">    
        <li>
    <a class="dropdown-item" href="../assessment/overview.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assessment/objectives.html">
 <span class="dropdown-text">Learning Objectives</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assessment/accountability.html">
 <span class="dropdown-text">Accountability</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assessment/engagement.html">
 <span class="dropdown-text">Community Engagement</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assessment/menu.html">
 <span class="dropdown-text">Project Menu</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assessment/enrichment.html">
 <span class="dropdown-text">Enrichment Activities</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assessment/data-project.html">
 <span class="dropdown-text">Integrative Data Project</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-materials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Materials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-materials">    
        <li>
    <a class="dropdown-item" href="../github.com/d2m-r/book/index.html">
 <span class="dropdown-text">Textbook (WIP)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../materials/slides.html">
 <span class="dropdown-text">Slides</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../materials/course-resources.html">
 <span class="dropdown-text">Course Resources</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../materials/resources.html">
 <span class="dropdown-text">External Resources</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../materials/finding-data.html">
 <span class="dropdown-text">Finding Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../d2m-r.github.io"> 
<span class="menu-text">FAQ</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#why-you-need-a-dataset" id="toc-why-you-need-a-dataset" class="nav-link active" data-scroll-target="#why-you-need-a-dataset">Why You Need a Dataset</a>
  <ul class="collapse">
  <li><a href="#using-your-own-data" id="toc-using-your-own-data" class="nav-link" data-scroll-target="#using-your-own-data">Using Your Own Data</a></li>
  <li><a href="#finding-public-data" id="toc-finding-public-data" class="nav-link" data-scroll-target="#finding-public-data">Finding Public Data</a></li>
  <li><a href="#essential-dataset-criteria" id="toc-essential-dataset-criteria" class="nav-link" data-scroll-target="#essential-dataset-criteria">Essential Dataset Criteria</a>
  <ul class="collapse">
  <li><a href="#completeness" id="toc-completeness" class="nav-link" data-scroll-target="#completeness">Completeness</a></li>
  <li><a href="#structural-consistency" id="toc-structural-consistency" class="nav-link" data-scroll-target="#structural-consistency">Structural Consistency</a></li>
  <li><a href="#plain-text-format" id="toc-plain-text-format" class="nav-link" data-scroll-target="#plain-text-format">Plain Text Format</a></li>
  <li><a href="#tabular-structure" id="toc-tabular-structure" class="nav-link" data-scroll-target="#tabular-structure">Tabular Structure</a></li>
  <li><a href="#research-question-alignment" id="toc-research-question-alignment" class="nav-link" data-scroll-target="#research-question-alignment">Research Question Alignment</a></li>
  <li><a href="#anonymization" id="toc-anonymization" class="nav-link" data-scroll-target="#anonymization">Anonymization</a></li>
  </ul></li>
  <li><a href="#common-pitfalls" id="toc-common-pitfalls" class="nav-link" data-scroll-target="#common-pitfalls">Common Pitfalls</a></li>
  <li><a href="#getting-help" id="toc-getting-help" class="nav-link" data-scroll-target="#getting-help">Getting Help</a></li>
  </ul></li>
  <li><a href="#public-data" id="toc-public-data" class="nav-link" data-scroll-target="#public-data">Public Data</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Finding Data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="why-you-need-a-dataset" class="level1">
<h1>Why You Need a Dataset</h1>
<p>The integrative data project requires you to demonstrate the full research workflow: data preparation, analysis, and manuscript reporting. You’ll build a reproducible pipeline from raw data to publication-ready output.</p>
<p>This differs from core standards projects, which focus on specific technical skills. The integrative project integrates everything across the quarter.</p>
<p>Your dataset should be complete enough to support a full analysis pipeline—from data cleaning and transformation through statistical modeling to final visualization. Even in D2M-R I when we don’t cover advanced analysis, this should still be the goal for your data. This means having sufficient observations, relevant variables for your research questions, and enough complexity to demonstrate meaningful data wrangling skills without being so messy that cleaning becomes the entire project.</p>
<section id="using-your-own-data" class="level2">
<h2 class="anchored" data-anchor-id="using-your-own-data">Using Your Own Data</h2>
<p>“Your own data” means data you have a personal stake in analyzing as part of research you’re conducting or contributing to. This includes:</p>
<ul>
<li>Thesis or dissertation data (BA, MA, or PhD)</li>
<li>Data from a lab you work in or research team you’re part of</li>
<li>Data you’re collecting for a faculty member’s project</li>
<li>Pilot data from studies you’re designing</li>
<li>Data from independent research projects</li>
</ul>
<p>It does not necessarily have to be data you collected yourself, and it can even be data collected for an entirely different purpose. “Your” data just means it’s something you’re bringing to the table for your own work rather than trying to find something out there to make work for this class specifically.</p>
<p><strong>Quarter 1:</strong> Using your own data is strongly preferred. Students working with thesis data (BA or MA), lab projects, or ongoing research get the most from this course. You’ll build directly applicable skills and advance your actual research.</p>
<p><strong>Quarter 2:</strong> You are required to use your own data for the integrative project. You must have a dataset with personal investment and clear research questions before the start of the quarter.</p>
<p>If you lack your own data, publicly available datasets work for Quarter 1. However, start identifying your own dataset early—you’ll need it by Quarter 2.</p>
</section>
<section id="finding-public-data" class="level2">
<h2 class="anchored" data-anchor-id="finding-public-data">Finding Public Data</h2>
<p><strong>Start with your research question.</strong> Identify the domain (psychology, public health, social science) and core variables you need. This focus prevents getting lost in vast repositories.</p>
<p><strong>Use multiple search approaches:</strong></p>
<ul>
<li><strong>Domain-specific repositories</strong> (ICPSR, Roper, Journal of Open Psychology Data) offer curated, documented datasets</li>
<li><strong>Meta-search engines</strong> (Google Dataset Search, <a href="http://re3data.org">re3data.org</a>) cast a wider net across repositories</li>
<li><strong>General platforms</strong> (Harvard Dataverse, Figshare, Kaggle) provide diverse options with varying quality</li>
<li><strong>Specialized collections</strong> (Data is Plural, Components, Awesome Public Datasets) surface interesting datasets you might not find otherwise</li>
</ul>
<p><strong>Evaluate documentation quality.</strong> Well-documented datasets include codebooks, data dictionaries, and methodology descriptions. Poor documentation will cost you time and introduce errors.</p>
<p>See below for a list of public data collections to get started.</p>
</section>
<section id="essential-dataset-criteria" class="level2">
<h2 class="anchored" data-anchor-id="essential-dataset-criteria">Essential Dataset Criteria</h2>
<section id="completeness" class="level3">
<h3 class="anchored" data-anchor-id="completeness">Completeness</h3>
<p>You need a dataset covering all variables for your analysis. If your research question requires demographics, behavioral measures, and temporal data, the dataset must include all three.</p>
<p>Partial datasets work only if you can extract a complete subset. Pilot data with full variable coverage beats a larger dataset missing key variables.</p>
</section>
<section id="structural-consistency" class="level3">
<h3 class="anchored" data-anchor-id="structural-consistency">Structural Consistency</h3>
<p>Check for uniform column names, consistent date formats, and standardized categorical values. Inconsistencies like “Yes”/“yes”/“Y” or “01/15/2024”/“2024-01-15” create silent errors that corrupt analyses.</p>
<p>Inspect the first 50-100 rows for structural oddities before committing to a dataset. Structural inconsistency at the outset doesn’t need to be a dealbreaker, but it means you’ll have more work to do in data preparation stages.</p>
</section>
<section id="plain-text-format" class="level3">
<h3 class="anchored" data-anchor-id="plain-text-format">Plain Text Format</h3>
<p>R processes plain text. While packages can read Excel or SPSS files, you’ll convert them to CSV or TSV eventually. Start with formats ending in .csv, .tsv, or .txt when possible.</p>
<p>Most repositories offer CSV export. If only proprietary formats exist, verify conversion tools work before investing time in the dataset.</p>
</section>
<section id="tabular-structure" class="level3">
<h3 class="anchored" data-anchor-id="tabular-structure">Tabular Structure</h3>
<p>Data must organize into rows and columns. Standard tidy format (each column = variable, each row = observation) simplifies analysis, but transposed or nested structures work if convertible.</p>
<p>Spreadsheets typically meet this criterion. Unstructured text or XML requires preprocessing.</p>
</section>
<section id="research-question-alignment" class="level3">
<h3 class="anchored" data-anchor-id="research-question-alignment">Research Question Alignment</h3>
<p>The dataset must enable answering specific research questions. On day one, articulate 2-3 concrete questions the data can address.</p>
<p>Students with interesting research projects tend to be more interested in the work and generally learn more. Generic exploration of unfocused datasets produces generic insights.</p>
</section>
<section id="anonymization" class="level3">
<h3 class="anchored" data-anchor-id="anonymization">Anonymization</h3>
<p>GitHub retains complete history. Only commit fully anonymized data. Never plan to “anonymize later.”</p>
<p>For human subjects data, verify no personally identifiable information exists. Random participant IDs, geographic aggregation to region level, and date jittering are standard approaches.</p>
<p>If you are using publicly available data from a credible source, you don’t have to worry about anonymization. However, if you are using your own data or “quasi-”open data (like from a large research project with collaborators at multiple institutions), you’ll need to be very careful about this.</p>
<p>Check with advisors about discipline-specific anonymization standards.</p>
</section>
</section>
<section id="common-pitfalls" class="level2">
<h2 class="anchored" data-anchor-id="common-pitfalls">Common Pitfalls</h2>
<p><strong>Dataset too large.</strong> Start with manageable size (under 100MB). You can always expand later.</p>
<p><strong>Missing codebook.</strong> Variable names like “V1”, “V2”, “Q37” without explanation make analysis impossible.</p>
<p><strong>Aggregated data when you need individual observations.</strong> Summary statistics can’t be disaggregated.</p>
<p><strong>Licensing restrictions.</strong> Verify the dataset permits academic use and redistribution if needed.</p>
<p><strong>Format mismatch.</strong> PDF tables or image-based data require extraction work that exceeds course scope.</p>
</section>
<section id="getting-help" class="level2">
<h2 class="anchored" data-anchor-id="getting-help">Getting Help</h2>
<p>If uncertain about dataset suitability, download it, examine the first few rows, and bring specific questions to Dr.&nbsp;Dowling or your TA. “Can this work?” questions need concrete examples, not abstract descriptions.</p>
</section>
</section>
<section id="public-data" class="level1">
<h1>Public Data</h1>
<ul>
<li><a href="http://www.sthda.com/english/wiki/r-built-in-data-sets">Find and use R’s built-in datasets</a>
<ul>
<li>Not suitable for integrative data projects, but great for practice and core standards projects</li>
</ul></li>
<li><a href="https://data.gov/">data.gov</a></li>
<li><a href="https://data.cityofchicago.org/">Chicago Data Portal</a></li>
<li><a href="https://dataverse.harvard.edu/dataverse/harvard?q=&amp;fq0=subject_ss%3A%22Social%20Sciences%22&amp;types=dataverses%3Adatasets&amp;sort=dateSort&amp;order=desc">Harvard’s Data Repository</a></li>
<li><a href="https://www.icpsr.umich.edu/web/pages/ICPSR/index.html">ICPSR Data Repository</a></li>
<li><a href="https://datasetsearch.research.google.com/">Google’s Dataset Search</a></li>
<li><a href="https://www.kaggle.com/">Kaggle datasets</a></li>
<li><a href="https://components.one/datasets">Components Datasets</a></li>
<li><a href="https://ropercenter-cornell-edu.proxy.uchicago.edu/ipoll/">Roper iPoll public opinion data</a></li>
<li><a href="https://registry.opendata.aws/">AWS Data</a></li>
<li><a href="https://data.world/datasets/open-data">Data.world open datasets</a></li>
<li><a href="https://www.re3data.org/">re3data.org registry of data repositories</a></li>
<li><a href="https://openpsychologydata.metajnl.com/">Journal of Open Psychology Data</a></li>
<li><a href="https://openarchaeologydata.metajnl.com/">Journal of Open Archeology Data</a></li>
<li><a href="https://openhealthdata.metajnl.com/">Journal of Open Public Health Data</a></li>
<li><a href="https://www.opendatanetwork.com/">Open Data Network</a></li>
<li><a href="https://figshare.com/">Figshare</a></li>
<li><a href="https://github.com/awesomedata/awesome-public-datasets">Awesome Public Datasets on Github</a></li>
<li><a href="https://docs.google.com/spreadsheets/d/1wZhPLMCHKJvwOkP4juclhjFgqIY8fQFMemwKL2c64vk/edit#gid=0">Data is plural database (fun datasets of all types!)</a></li>
</ul>
<p><em>Thank you to <a href="https://macs40700.netlify.app/faq/finding-data/">Dr.&nbsp;Jean Clipperton</a> for compiling the majority of this list for her class on Data Visualization!</em></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>